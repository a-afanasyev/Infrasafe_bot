# üîÑ –ú–ò–ì–†–ê–¶–ò–Ø –ë–ê–ó–´ –î–ê–ù–ù–´–• –ó–ê–í–ï–†–®–ï–ù–ê

## ‚úÖ –ü–†–û–ë–õ–ï–ú–ê –†–ï–®–ï–ù–ê

**–î–∞—Ç–∞:** 16 –∞–≤–≥—É—Å—Ç–∞ 2024, 21:27  
**–°—Ç–∞—Ç—É—Å:** –£—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ  

### üîç **–î–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- –û—à–∏–±–∫–∏ "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ" –≤ Telegram
- –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —É—Å—Ç–∞—Ä–µ–ª–∞ - –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ –∫–æ–ª–æ–Ω–∫–∏ `roles` –∏ `active_role`
- SQLAlchemy ORM –Ω–µ –º–æ–≥ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–æ–≤–æ–π –º–æ–¥–µ–ª—å—é User

### üõ†Ô∏è **–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**

#### 1. –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏:
```sql
ALTER TABLE users ADD COLUMN roles TEXT DEFAULT NULL;
ALTER TABLE users ADD COLUMN active_role VARCHAR(50) DEFAULT NULL;
```

#### 2. –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö:
- –°—Ç–∞—Ä–∞—è –∫–æ–ª–æ–Ω–∫–∞ `role` ‚Üí –Ω–æ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ `roles` (JSON —Ñ–æ—Ä–º–∞—Ç)
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ `active_role` = —Ç–µ–∫—É—â–∞—è —Ä–æ–ª—å
- –ü—Ä–∏–º–µ—Ä: `"manager"` ‚Üí `["manager"]` + `active_role = "manager"`

#### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏:
- ‚úÖ –í—Å–µ 5 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –í—Å–µ –∞–¥—Ä–µ—Å–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
- ‚úÖ –í—Å–µ 15 –∑–∞—è–≤–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
- ‚úÖ AuthService —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–∏:**

| –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | –°—Ç–∞—Ä–∞—è —Ä–æ–ª—å | –ù–æ–≤—ã–µ —Ä–æ–ª–∏ | –ê–∫—Ç–∏–≤–Ω–∞—è —Ä–æ–ª—å | –ê–¥—Ä–µ—Å |
|-------------|-------------|------------|---------------|--------|
| 48617336 | manager | ["manager"] | manager | –£–ª. –ª–µ–Ω–∏–Ω–∞, –¥–æ–º 15, –∫–≤. 25 |
| 987654321 | applicant | ["applicant"] | applicant | –£–ª. –ª–µ–Ω–∏–Ω–∞, –¥–æ–º 1 |
| 555666777 | applicant | ["applicant"] | applicant | –£–ª. —Ç–µ—Å—Ç–æ–≤–∞—è, –¥–æ–º 1 |
| 987654322 | applicant | ["applicant"] | applicant | –£–ª. –ª–µ–Ω–∏–Ω–∞, –¥–æ–º 15, –∫–≤. 25 |
| 987654323 | applicant | ["applicant"] | applicant | –£–ª. –ª–µ–Ω–∏–Ω–∞, –¥–æ–º 15, –∫–≤. 25 |

### üéØ **–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:**
- ‚úÖ **–ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è** –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ AuthService
- ‚úÖ **–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã** - –∞–¥—Ä–µ—Å–∞, –∑–∞—è–≤–∫–∏, –∏—Å—Ç–æ—Ä–∏—è

### üìù **–õ–æ–≥–∏ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:**
```
2025-08-16 21:27:54,455 - handlers.base - INFO - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å 48617336 –∑–∞–ø—É—Å—Ç–∏–ª –±–æ—Ç–∞
2025-08-16 21:27:54,455 - aiogram.event - INFO - Update id=814415969 is handled. Duration 356 ms
```

### üöÄ **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
2. –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
3. –ú–Ω–æ–≥–æ—Ä–æ–ª–µ–≤–æ–π —Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–µ–Ω
4. Security –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã

**‚úÖ –ú–ò–ì–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê –£–°–ü–ï–®–ù–û - –ë–û–¢ –ü–û–õ–ù–û–°–¢–¨–Æ –ì–û–¢–û–í –ö –†–ê–ë–û–¢–ï!**
