# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Media Service

**–ü—Ä–æ–±–ª–µ–º–∞**: –ë–æ—Ç –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ Media Service
**–û—à–∏–±–∫–∞**: `Health check failed: [Errno -2] Name or service not known`

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–ë–æ—Ç –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –∞–¥—Ä–µ—Å—É:
```
Media Service –∫–ª–∏–µ–Ω—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω: http://host.docker.internal:8001
```

–ù–æ –¥–æ–ª–∂–µ–Ω –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫:
```
http://media-service:8000
```

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
grep MEDIA_SERVICE_URL .env

# 2. –ï—Å–ª–∏ —Ç–∞–º –ù–ï http://media-service:8000, –∏—Å–ø—Ä–∞–≤–∏—Ç—å:
nano .env

# 3. –ù–∞–π—Ç–∏ —Å—Ç—Ä–æ–∫—É MEDIA_SERVICE_URL –∏ –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞:
MEDIA_SERVICE_URL=http://media-service:8000

# 4. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å (Ctrl+O, Enter, Ctrl+X)

# 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã:
make restart

# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:
docker logs uk-bot | grep -i "media service"
```

---

## üìã –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –ª–æ–≥–∞—Ö uk-bot –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
INFO: Media Service –∫–ª–∏–µ–Ω—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω: http://media-service:8000
INFO: Media Service –¥–æ—Å—Ç—É–ø–µ–Ω: http://media-service:8000
```

–í–º–µ—Å—Ç–æ:
```
ERROR: Health check failed: [Errno -2] Name or service not known
WARNING: –ë–æ—Ç –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ Media Service
```

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã Media Service

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ media-service –¥–æ—Å—Ç—É–ø–µ–Ω –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏
```bash
docker exec uk-bot curl http://media-service:8000/api/v1/health
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç**:
```json
{"status":"ok","service":"media-service","version":"1.0.0"}
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ media-service —Å–ª—É—à–∞–µ—Ç –ø–æ—Ä—Ç 8000
```bash
docker exec uk-media-service netstat -tlnp | grep 8000
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥**:
```
tcp  0  0.0.0.0:8000  0.0.0.0:*  LISTEN  1/python
```

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–µ—Ä–≤–∏—Å—ã –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏
```bash
docker network inspect infrasafe_bot_uk-network | grep -A 3 "uk-bot\|uk-media-service"
```

---

## üéØ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –í .env —Ñ–∞–π–ª–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:

```bash
# ==================== MEDIA SERVICE ====================
# URL Media Service (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π Docker network)
MEDIA_SERVICE_URL=http://media-service:8000
```

### ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
```bash
MEDIA_SERVICE_URL=http://host.docker.internal:8001  # –°—Ç–∞—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
MEDIA_SERVICE_URL=http://localhost:8009             # –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Docker
MEDIA_SERVICE_URL=http://127.0.0.1:8009             # –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Docker
```

### ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
```bash
MEDIA_SERVICE_URL=http://media-service:8000  # –ò–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ Docker network
```

---

## üìå –í–∞–∂–Ω–æ

1. **–ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ localhost** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –æ–±—â–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ Docker network
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞** - `media-service` (–∏–∑ docker-compose.unified.yml)
3. **–ü–æ—Ä—Ç 8000** - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –ø–æ—Ä—Ç uvicorn (–Ω–µ 8009 –∫–æ—Ç–æ—Ä—ã–π exposed –Ω–∞—Ä—É–∂—É)
4. **–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è .env** - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ: `make restart`

---

## üîÑ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

–ï—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏—Ç–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env, –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª:

```bash
# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π .env
rm .env

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ –ø—Ä–∏–º–µ—Ä–∞
cp .env.unified.example .env

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:
nano .env
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:
# - BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω
# - MEDIA_BOT_TOKEN=–≤–∞—à_–º–µ–¥–∏–∞_—Ç–æ–∫–µ–Ω
# - POSTGRES_PASSWORD=–≤–∞—à_–ø–∞—Ä–æ–ª—å
# - DATABASE_URL=postgresql://uk_bot:–≤–∞—à_–ø–∞—Ä–æ–ª—å@postgres:5432/uk_management

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
make restart
```

---

**–î–∞—Ç–∞**: 15 –æ–∫—Ç—è–±—Ä—è 2025
**–°—Ç–∞—Ç—É—Å**: –¢—Ä–µ–±—É–µ—Ç—Å—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
